<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Screener Training - SMX KITS</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --dark-gradient: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 100%);
      --card-gradient: linear-gradient(145deg, #16213e 0%, #0f1419 100%);
      --glass-bg: rgba(255, 255, 255, 0.05);
      --glass-border: rgba(255, 255, 255, 0.1);
      --text-primary: #ffffff;
      --text-secondary: #b8c5d6;
      --text-accent: #64b5f6;
      --shadow-primary: 0 20px 40px rgba(0, 0, 0, 0.3);
      --shadow-hover: 0 30px 60px rgba(0, 0, 0, 0.4);
      --border-radius: 20px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--dark-gradient);
      color: var(--text-primary);
      overflow-x: hidden;
      line-height: 1.6;
      min-height: 100vh;
    }

    /* Animated background particles */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.1) 0%, transparent 50%);
      z-index: -1;
      animation: float 20s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      33% { transform: translateY(-20px) rotate(1deg); }
      66% { transform: translateY(10px) rotate(-1deg); }
    }

    .training-layout {
      display: flex;
      min-height: 100vh;
    }

    /* Left Sidebar - Module Picker */
    .module-sidebar {
      width: 320px;
      background: rgba(15, 20, 25, 0.95);
      backdrop-filter: blur(20px);
      border-right: 1px solid var(--glass-border);
      display: flex;
      flex-direction: column;
      padding: 2rem;
      position: relative;
      overflow: hidden;
    }

    .module-sidebar::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(180deg, rgba(102, 126, 234, 0.1) 0%, transparent 100%);
      z-index: -1;
    }

    .sidebar-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--glass-border);
    }

    .sidebar-title {
      font-size: 1.5rem;
      font-weight: 700;
      background: var(--primary-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .back-button {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      padding: 0.5rem 1rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .back-button:hover {
      background: var(--accent-gradient);
      color: white;
      transform: translateX(-2px);
    }

    .tool-card {
      background: var(--card-gradient);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-primary);
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .tool-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--primary-gradient);
      opacity: 0;
      transition: var(--transition);
    }

    .tool-card:hover::before {
      opacity: 0.1;
    }

    .tool-card:hover {
      transform: translateY(-5px) scale(1.02);
      box-shadow: var(--shadow-hover);
      border-color: rgba(102, 126, 234, 0.5);
    }

    .tool-card.active {
      border-color: rgba(102, 126, 234, 0.8);
      background: linear-gradient(145deg, #1a2a4e 0%, #0f1419 100%);
    }

    .tool-title {
      font-size: 1.2rem;
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }

    .practices-list {
      display: none;
      margin-top: 1rem;
      padding-top: 1rem;
      border-top: 1px solid var(--glass-border);
    }

    .practices-list.active {
      display: block;
    }

    .practice-button {
      display: block;
      width: 100%;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      padding: 0.75rem 1rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: var(--transition);
      margin-bottom: 0.5rem;
      text-align: left;
    }

    .practice-button:hover {
      background: var(--accent-gradient);
      color: white;
      transform: translateX(5px);
    }

    .practice-button.active {
      background: var(--secondary-gradient);
      color: white;
    }

    /* Right Content Area */
    .training-content {
      flex: 1;
      padding: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .instruction-header {
      background: var(--card-gradient);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-primary);
      text-align: center;
    }

    .instruction-text {
      font-size: 1.3rem;
      font-weight: 600;
      color: var(--text-accent);
      margin: 0;
    }

    .video-section {
      flex: 1;
      background: var(--card-gradient);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-primary);
      display: flex;
      flex-direction: column;
      min-height: 500px;
    }

    .video-container {
      flex: 1;
      position: relative;
      background: #000;
      border-radius: 15px;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .training-video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .video-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem;
      background: rgba(0, 0, 0, 0.8);
      border-radius: 10px;
      margin-bottom: 1rem;
    }

    .play-pause-btn {
      background: var(--accent-gradient);
      border: none;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      color: white;
      font-size: 1.2rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .play-pause-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 10px 25px rgba(79, 172, 254, 0.4);
    }

    .progress-container {
      flex: 1;
      margin: 0 1rem;
      height: 6px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 3px;
      overflow: hidden;
    }

    .progress-bar {
      height: 100%;
      background: var(--accent-gradient);
      width: 0%;
      transition: width 0.1s ease;
    }

    .zoom-controls {
      display: flex;
      gap: 0.5rem;
    }

    .zoom-btn {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      padding: 0.5rem;
      color: var(--text-primary);
      cursor: pointer;
      transition: var(--transition);
    }

    .zoom-btn:hover {
      background: var(--primary-gradient);
      color: white;
    }

    .input-section {
      background: var(--card-gradient);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-primary);
    }

    .sitrep-textarea {
      width: 100%;
      min-height: 120px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 15px;
      padding: 1rem;
      color: var(--text-primary);
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      margin-bottom: 1rem;
    }

    .sitrep-textarea:focus {
      outline: none;
      border-color: rgba(102, 126, 234, 0.5);
      box-shadow: 0 0 20px rgba(102, 126, 234, 0.2);
    }

    .submit-btn {
      width: 100%;
      background: var(--secondary-gradient);
      border: none;
      border-radius: 15px;
      padding: 1rem 2rem;
      color: white;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 35px rgba(245, 87, 108, 0.4);
    }

    .submit-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Feedback Overlay */
    .feedback-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    .feedback-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    .feedback-content {
      background: var(--card-gradient);
      border-radius: var(--border-radius);
      padding: 2rem;
      border: 1px solid var(--glass-border);
      box-shadow: var(--shadow-hover);
      max-width: 90%;
      max-height: 90%;
      overflow-y: auto;
      display: flex;
      gap: 2rem;
      min-width: 800px;
    }

    .feedback-column {
      flex: 1;
    }

    .feedback-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--text-accent);
    }

    .feedback-text {
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      padding: 1rem;
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 200px;
    }

    .hidden {
      display: none !important;
    }

    /* Responsive Design */
    @media (max-width: 1024px) {
      .training-layout {
        flex-direction: column;
      }
      
      .module-sidebar {
        width: 100%;
        height: auto;
        max-height: 300px;
        overflow-y: auto;
      }
      
      .feedback-content {
        flex-direction: column;
        min-width: auto;
        max-width: 95%;
      }
    }
  </style>
</head>
<body>
  <div class="training-layout">
    <!-- Left Sidebar - Module Picker -->
    <aside class="module-sidebar">
      <div class="sidebar-header">
        <h1 class="sidebar-title">Screener Training</h1>
        <button class="back-button" onclick="goBack()">
          <i class="fas fa-arrow-left"></i>
          Back
        </button>
      </div>
      
      <div id="modules-container">
        <!-- Modules will be generated here -->
      </div>
    </aside>
    
    <!-- Right Content Area -->
    <main class="training-content">
      <!-- Instruction Header -->
      <div class="instruction-header hidden" id="instruction-header">
        <p class="instruction-text">Create a SITREP for the Named Area of Interest, NAI-078</p>
      </div>
      
      <!-- Video Section -->
      <div class="video-section hidden" id="video-section">
        <div class="video-container">
          <video id="training-video" class="training-video" loop muted>
            <source src="Screener Training.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
        
        <div class="video-controls">
          <button class="play-pause-btn" id="play-pause-btn">
            <i class="fas fa-play"></i>
          </button>
          
          <div class="progress-container">
            <div class="progress-bar" id="progress-bar"></div>
          </div>
          
          <div class="zoom-controls">
            <button class="zoom-btn" onclick="zoomVideo(-0.1)">
              <i class="fas fa-search-minus"></i>
            </button>
            <button class="zoom-btn" onclick="zoomVideo(0.1)">
              <i class="fas fa-search-plus"></i>
            </button>
          </div>
        </div>
      </div>
      
      <!-- Input Section -->
      <div class="input-section hidden" id="input-section">
        <textarea 
          id="sitrep-textarea" 
          class="sitrep-textarea" 
          placeholder="Enter your SITREP here..."
        ></textarea>
        <button class="submit-btn" id="submit-btn" onclick="submitSitrep()">
          Submit SITREP
        </button>
      </div>
    </main>
  </div>
  
  <!-- Feedback Overlay -->
  <div class="feedback-overlay" id="feedback-overlay">
    <div class="feedback-content">
      <div class="feedback-column">
        <h3 class="feedback-title">Your SITREP</h3>
        <div class="feedback-text" id="user-sitrep"></div>
      </div>
      <div class="feedback-column">
        <h3 class="feedback-title">Reference SITREP</h3>
        <div class="feedback-text" id="reference-sitrep">
          SITREP NAI-078: At 1430 hours, observed two military-aged males approaching the compound from the northeast. Primary subject carrying what appears to be communications equipment. Secondary subject maintaining overwatch position approximately 50 meters from main entrance. Both subjects wearing civilian clothing but displaying tactical movement patterns. Recommend continued surveillance and preparation for potential engagement.
        </div>
      </div>
    </div>
  </div>

  <script>
    // Global variables
    let currentModule = null;
    let currentPractice = null;
    let currentZoom = 1;
    let video = null;
    let isPlaying = false;

    // Initialize the application
    function init() {
      renderModules();
      setupVideoControls();
    }

    // Render modules in sidebar
    function renderModules() {
      const container = document.getElementById('modules-container');
      container.innerHTML = '';
      
      for (let i = 1; i <= 5; i++) {
        const moduleCard = document.createElement('div');
        moduleCard.className = 'tool-card';
        moduleCard.innerHTML = `
          <div class="tool-title">Module ${i}</div>
          <div class="practices-list" id="practices-${i}">
            ${generatePractices(i)}
          </div>
        `;
        
        moduleCard.addEventListener('click', (e) => {
          if (e.target.classList.contains('practice-button')) return;
          toggleModule(i);
        });
        
        container.appendChild(moduleCard);
      }
    }

    // Generate practices for a module
    function generatePractices(moduleNum) {
      let practicesHTML = '';
      for (let p = 1; p <= 10; p++) {
        practicesHTML += `
          <button class="practice-button" onclick="selectPractice(${moduleNum}, ${p}, this)">
            Practice ${p}
          </button>
        `;
      }
      return practicesHTML;
    }

    // Toggle module expansion
    function toggleModule(moduleNum) {
      const practicesList = document.getElementById(`practices-${moduleNum}`);
      const moduleCard = practicesList.closest('.tool-card');
      
      // Close all other modules
      document.querySelectorAll('.practices-list').forEach(list => {
        if (list.id !== `practices-${moduleNum}`) {
          list.classList.remove('active');
          list.closest('.tool-card').classList.remove('active');
        }
      });
      
      // Toggle current module
      practicesList.classList.toggle('active');
      moduleCard.classList.toggle('active');
    }

    // Select a practice
    function selectPractice(moduleNum, practiceNum, buttonElement) {
      console.log('selectPractice called with:', moduleNum, practiceNum);
      currentModule = moduleNum;
      currentPractice = practiceNum;
      
      // Update active practice button
      document.querySelectorAll('.practice-button').forEach(btn => {
        btn.classList.remove('active');
      });
      if (buttonElement) {
        buttonElement.classList.add('active');
        console.log('Button marked as active');
      }
      
      // Show training interface
      showTrainingInterface();
    }

    // Show the training interface
    function showTrainingInterface() {
      console.log('Showing training interface for Module', currentModule, 'Practice', currentPractice);
      
      const instructionHeader = document.getElementById('instruction-header');
      const videoSection = document.getElementById('video-section');
      const inputSection = document.getElementById('input-section');
      
      if (instructionHeader) {
        instructionHeader.classList.remove('hidden');
        console.log('Instruction header shown');
      } else {
        console.error('Instruction header element not found');
      }
      
      if (videoSection) {
        videoSection.classList.remove('hidden');
        console.log('Video section shown');
      } else {
        console.error('Video section element not found');
      }
      
      if (inputSection) {
        inputSection.classList.remove('hidden');
        console.log('Input section shown');
      } else {
        console.error('Input section element not found');
      }
      
      // Initialize video
      video = document.getElementById('training-video');
      if (video) {
        video.load();
        console.log('Video loaded');
      } else {
        console.error('Video element not found');
      }
      
      // Clear previous input
      const textarea = document.getElementById('sitrep-textarea');
      if (textarea) {
        textarea.value = '';
        console.log('Textarea cleared');
      } else {
        console.error('Textarea element not found');
      }
    }

    // Setup video controls
    function setupVideoControls() {
      const playPauseBtn = document.getElementById('play-pause-btn');
      const progressBar = document.getElementById('progress-bar');
      
      playPauseBtn.addEventListener('click', togglePlayPause);
      
      // Update progress bar
      document.addEventListener('DOMContentLoaded', () => {
        const video = document.getElementById('training-video');
        if (video) {
          video.addEventListener('timeupdate', updateProgress);
          video.addEventListener('loadedmetadata', () => {
            video.currentTime = 0;
          });
        }
      });
    }

    // Toggle play/pause
    function togglePlayPause() {
      if (!video) return;
      
      const playPauseBtn = document.getElementById('play-pause-btn');
      const icon = playPauseBtn.querySelector('i');
      
      if (video.paused) {
        video.play();
        icon.className = 'fas fa-pause';
        isPlaying = true;
      } else {
        video.pause();
        icon.className = 'fas fa-play';
        isPlaying = false;
      }
    }

    // Update progress bar
    function updateProgress() {
      if (!video) return;
      
      const progressBar = document.getElementById('progress-bar');
      const progress = (video.currentTime / video.duration) * 100;
      progressBar.style.width = progress + '%';
    }

    // Zoom video function
    function zoomVideo(delta) {
      if (!video) return;
      
      currentZoom += delta;
      currentZoom = Math.max(0.5, Math.min(3, currentZoom)); // Limit zoom between 0.5x and 3x
      
      video.style.transform = `scale(${currentZoom})`;
    }

    // Handle mouse wheel zoom
    document.addEventListener('DOMContentLoaded', () => {
      const videoContainer = document.querySelector('.video-container');
      if (videoContainer) {
        videoContainer.addEventListener('wheel', (e) => {
          e.preventDefault();
          const delta = e.deltaY > 0 ? -0.1 : 0.1;
          zoomVideo(delta);
        });
      }
    });

    // Submit SITREP
    function submitSitrep() {
      const userSitrep = document.getElementById('sitrep-textarea').value.trim();
      
      if (!userSitrep) {
        alert('Please enter your SITREP before submitting.');
        return;
      }
      
      // Show feedback overlay
      showFeedback(userSitrep);
    }

    // Show feedback overlay
    function showFeedback(userSitrep) {
      const overlay = document.getElementById('feedback-overlay');
      const userSitrepDiv = document.getElementById('user-sitrep');
      
      userSitrepDiv.textContent = userSitrep;
      overlay.classList.add('active');
      
      // Auto-close after 10 seconds
      setTimeout(() => {
        closeFeedback();
      }, 10000);
    }

    // Close feedback overlay
    function closeFeedback() {
      const overlay = document.getElementById('feedback-overlay');
      overlay.classList.remove('active');
      
      // Reset for next practice
      document.getElementById('sitrep-textarea').value = '';
      if (video) {
        video.currentTime = 0;
        video.pause();
        const playPauseBtn = document.getElementById('play-pause-btn');
        const icon = playPauseBtn.querySelector('i');
        icon.className = 'fas fa-play';
        isPlaying = false;
      }
    }

    // Close feedback when clicking outside
    document.addEventListener('click', (e) => {
      const overlay = document.getElementById('feedback-overlay');
      if (e.target === overlay) {
        closeFeedback();
      }
    });

    // Navigation
    function goBack() {
      window.location.href = 'dashboard.html';
    }

    // Initialize when DOM is loaded
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
